extends layout

block content
	h1= title
	table#flip-scroll.cf.table-condensed.table-hover.table-striped.listing.span7
		thead
			tr
				th.hidden-phone.hidden-tablet Image salle
				th Salle
				th Date d'arrivée
				th Date de départ
				th Promotion
				th Réduction
				th Prix
				th Supprimer
		tbody
			- if (session.panier)
				- each data in session.panier
					tr(data-salle_id="#{data.salle_id}", data-produit_id="#{data.produit_id}", data-promotion_id="#{data.promotion_id}")
						td.hidden-phone.hidden-tablet 
							img(src="../images/vignettes/#{data.salle_image}", width="50", height="50")
						td #{data.salle_title}
						td #{moment(data.arrive).format('DD/MM/YYYY HH:mm')}
						td #{moment(data.depart).format('DD/MM/YYYY HH:mm')}
						td #{data.promotion_code}
						td #{data.promotion_reduction} €
						td #{data.prix} €
						td 
							a.remove-from-cart(data-id="#{data.produit_id}")
								img(src="images/icons/erase.png")
	a#empty_cart.btn.btn-info Vider le panier
//
	- var data_json = JSON.stringify( data );
	- var add_or_remove = 'add'
	- if (session.panier && session.panier != null)	
		- each panier_obj in session.panier	
			- if (panier_obj != null && panier_obj.produit_id == data.id)
				- add_or_remove = 'remove'
	- if (add_or_remove == 'remove')
		a.remove-from-cart(class="#{data_class}", data-id="#{data._id}") Retirer du panier >
	- else
		a.add-to-cart(class="#{data_class}", data-id="#{data._id}", href="#modal-panier", role="button", data-toggle="modal") Ajouter au panier >
	textarea.datas-json.hidden(id="datas-json-"+"#{data._id}") #{data_json}